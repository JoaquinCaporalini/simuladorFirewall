-- Haskell data types for the abstract syntax.
-- Generated by the BNF converter.

module AbsSimFirewall where

data Program = Prog [Function]
  deriving (Eq, Ord, Show, Read)

data Function = Rules [Rule] | Host [Inter] | Packages [PInfo]
  deriving (Eq, Ord, Show, Read)

data Rule = Rul Tab Com Mat Target
  deriving (Eq, Ord, Show, Read)

data Inter = Intrface String Ip String
  deriving (Eq, Ord, Show, Read)

data PInfo
    = PInfoTcp IntEstTCP Ip String Ip Integer Integer Integer Integer
    | PInfoUdp Ip String Ip Integer Integer Integer
    | PInfoIcmp Ip String Ip Integer Integer Integer Integer Integer Integer Integer
  deriving (Eq, Ord, Show, Read)

data Tab = TNat | TMan | TFil
  deriving (Eq, Ord, Show, Read)

data Com
    = CApp Cha
    | CDel Cha
    | CRep Cha Integer
    | CIns Cha Integer
    | CFlu Cha
    | CPol Cha Target
    | CNil
  deriving (Eq, Ord, Show, Read)

data Cha = DInp | DOut | DFor
  deriving (Eq, Ord, Show, Read)

data Mat
    = MPro [Protocolo] [Pop]
    | MNPro [Protocolo] [Pop]
    | MSrc Ip
    | MDst Ip
    | MInt String
    | MOut String
    | MFra
    | MNFra
    | MState State
    | MMacS
    | MNMacS
    | MNil
  deriving (Eq, Ord, Show, Read)

data Protocolo = PUdp | PTcp | PIcmp | PAll
  deriving (Eq, Ord, Show, Read)

data Ip
    = IpR Integer Integer Integer Integer Integer
    | IpU Integer Integer Integer Integer
  deriving (Eq, Ord, Show, Read)

data Pop
    = ODPortS Integer
    | ONDPortS Integer
    | OSPortS Integer
    | ONSPortS Integer
    | ODPortR Integer Integer
    | ONDPortR Integer Integer
    | OSPortR Integer Integer
    | ONSPortR Integer Integer
    | OTCPFlag Flags
    | OTCPNFlag Flags
    | OICMPFlag Flags
    | OICMPNFlag Flags
    | ONil
  deriving (Eq, Ord, Show, Read)

data Flags = FSYN | FFIN | FACK
  deriving (Eq, Ord, Show, Read)

data State = SNew | SInv | SEst | SRel
  deriving (Eq, Ord, Show, Read)

data Target = TgAccept | TgDrop | TgRegect | TgReturn | TgNill
  deriving (Eq, Ord, Show, Read)

data IntEstTCP
    = None
    | Established
    | SynSent
    | SynRecv
    | FinWait
    | TimeWait
    | Close
    | CloseWait
    | LastAck
    | Listen
  deriving (Eq, Ord, Show, Read)

